(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-95b3249c"],{"05d5":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-card",[n("el-form",{ref:"form",attrs:{model:t.form,inline:!0,"label-position":"right"}},[n("el-row",[n("el-col",{attrs:{span:10}},[n("el-form-item",{attrs:{label:"分类名称",prop:"spec"}},[n("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:10}},[n("div",{staticStyle:{width:"470px","margin-bottom":"25px"}},[t.formDisable?t._e():n("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",plain:"",icon:"el-icon-edit-outline"},on:{click:function(e){return t.handleDescribes("title")}}}),n("el-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[n("el-collapse-item",{attrs:{name:"title"}},[n("template",{slot:"title"},[n("span",{staticClass:"theHouseText"},[t._v("标题")])]),n("span",{domProps:{innerHTML:t._s(t.form.title)}})],2)],1)],1)]),n("el-col",{attrs:{span:10}},[n("div",{staticStyle:{width:"470px","margin-bottom":"25px"}},[t.formDisable?t._e():n("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",plain:"",icon:"el-icon-edit-outline"},on:{click:function(e){return t.handleDescribes("sub_title")}}}),n("el-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[n("el-collapse-item",{attrs:{name:"sub_title"}},[n("template",{slot:"title"},[n("span",{staticClass:"theHouseText"},[t._v("副标题")])]),n("span",{domProps:{innerHTML:t._s(t.form.sub_title)}})],2)],1)],1)])],1),n("el-row",[n("el-col",{attrs:{span:10}},[n("el-form-item",{attrs:{label:"banner图"}},[t.formDisable?n("el-image",{staticStyle:{width:"120px",height:"120px"},attrs:{src:t.form.banner,fit:"scale-down"},on:{click:function(e){return t.previewImgAction(t.form.banner)}}}):n("el-upload",{ref:"uploadBanner",class:{hideBanner:t.hideUploadBanner},attrs:{name:"banner",action:"#","list-type":"picture-card","auto-upload":!1,limit:t.limitCountBanner,"file-list":t.bannerList,"on-change":t.handleBannerChange,"on-remove":t.handleBannerRemove}},[n("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传一张jpg/png文件，且不超过500kb")])],1)],1)],1)],1)],1)],1),t.formDisable?t._e():n("el-card",{staticClass:"box-card-image",attrs:{shadow:"hover"}},[n("el-row",{staticStyle:{"margin-bottom":"50px"}},[n("el-col",{attrs:{span:2,offset:8}},[n("el-button",{attrs:{type:"success"},on:{click:function(e){return t.submitTheHouse()}}},[t._v("提交")])],1),n("el-col",{attrs:{span:2}},[n("el-button",{attrs:{type:"info",plain:""},on:{click:t.closePageButton}},[t._v("返回")])],1)],1)],1),n("el-dialog",{attrs:{title:"图片预览",visible:t.previewImgDialogVisible,width:"50%"},on:{"update:visible":function(e){t.previewImgDialogVisible=e}}},[n("el-image",{staticStyle:{width:"100%"},attrs:{src:t.previewImg}})],1),n("el-dialog",{attrs:{title:"富文本编辑",visible:t.showDialog,width:"50%","before-close":t.handleClose},on:{"update:visible":function(e){t.showDialog=e}}},[n("tinymce",{attrs:{height:150},model:{value:t.tinyTxt,callback:function(e){t.tinyTxt=e},expression:"tinyTxt"}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.showDialog=!1}}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.confirmSaveTiny}},[t._v("确 定")])],1)],1)],1)},a=[],s=(n("b0c0"),n("8256")),o=n("a718"),r={name:"HouseCategoryView",components:{Tinymce:s["a"]},data:function(){return{status:"",form:{name:"",title:"",sub_title:"",banner:""},category_slug:"",showDialog:!1,tinyTxt:"",flag:"",formDisable:!1,activeNames:["title","sub_title"],hideUploadBanner:!1,limitCountBanner:1,bannerList:[],previewImg:"",previewImgDialogVisible:!1}},created:function(){this.getInitData()},methods:{getInitData:function(){this.status=this.$route.params.status,"view"===this.status?(this.category_slug=this.$route.params.category_slug,this.formDisable=!0,this.getHouseCategoryDetail()):"edit"===this.status&&(this.category_slug=this.$route.params.category_slug,this.getHouseCategoryDetail(),this.hideUploadBanner=!0)},getHouseCategoryDetail:function(){var t=this;Object(o["g"])(this.category_slug).then((function(e){console.log(e),t.form=e.data,t.bannerList.push({url:t.form.banner})}))},handleDescribes:function(t){this.flag=t,this.tinyTxt="",this.showDialog=!0},confirmSaveTiny:function(){switch(this.flag){case"title":this.form.title=this.tinyTxt,this.showDialog=!1,this.tinyTxt="";break;case"sub_title":this.form.sub_title=this.tinyTxt,this.showDialog=!1,this.tinyTxt="";break}this.$message({message:"编辑完成",type:"success"})},handleClose:function(t){this.$confirm("确认关闭？").then((function(e){t()})).catch((function(t){}))},handleBannerChange:function(t,e){this.hideUploadBanner=e.length>=this.limitCountBanner,this.form.banner=t.raw},handleBannerRemove:function(t,e){this.hideUploadBanner=e.length>=this.limitCountBanner,this.form.banner=null},previewImgAction:function(t){this.previewImg=t,this.previewImgDialogVisible=!0},closePageButton:function(){this.$store.dispatch("tagsView/delView",this.$route),this.$router.go(-1)},submitTheHouse:function(){return this.form.name?this.form.sub_title?this.form.title?void("create"===this.status?this.theHouseCategoryStore():"edit"===this.status&&this.theHouseCategoryUpdate()):(this.$message({message:"标题不可为空！",type:"warning"}),!1):(this.$message({message:"副标题不可为空！",type:"warning"}),!1):(this.$message({message:"分类名称不可为空！",type:"warning"}),!1)},theHouseCategoryStore:function(){var t=this,e=new FormData;for(var n in this.form)e.append(n,this.form[n]);Object(o["i"])(e).then((function(e){20001===e.code?(t.initFormData(),t.$message({type:"success",message:"创建成功！"}),t.closePageButton()):t.$message({type:"error",message:"创建失败，请检查参数！"})}))},theHouseCategoryUpdate:function(){var t=this,e=new FormData;for(var n in this.form)e.append(n,this.form[n]);Object(o["j"])(this.form.slug,e).then((function(e){20001===e.code?(t.$message({type:"success",message:"更新成功！"}),t.closePageButton()):t.$message({type:"error",message:"更新失败，请检查参数！"})}))},initFormData:function(){this.$refs["form"].resetFields(),this.bannerList=[],this.hideUploadBanner=!1}}},l=r,u=(n("cf69"),n("2877")),c=Object(u["a"])(l,i,a,!1,null,null,null);e["default"]=c.exports},"778a":function(t,e,n){},a718:function(t,e,n){"use strict";n.d(e,"n",(function(){return a})),n.d(e,"m",(function(){return s})),n.d(e,"o",(function(){return o})),n.d(e,"p",(function(){return r})),n.d(e,"l",(function(){return l})),n.d(e,"h",(function(){return u})),n.d(e,"g",(function(){return c})),n.d(e,"i",(function(){return h})),n.d(e,"j",(function(){return m})),n.d(e,"f",(function(){return d})),n.d(e,"k",(function(){return f})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return g})),n.d(e,"e",(function(){return b})),n.d(e,"a",(function(){return y})),n.d(e,"d",(function(){return v}));var i=n("b775");function a(t){return Object(i["a"])({url:"admin/the_houses",method:"get",params:t})}function s(t){return Object(i["a"])({url:"/admin/the_house/"+t,method:"get"})}function o(t){return Object(i["a"])({url:"/admin/the_house",method:"post",data:t})}function r(t,e){return Object(i["a"])({url:"/admin/the_house/"+t,method:"post",data:e})}function l(t){return Object(i["a"])({url:"/admin/the_house/"+t,method:"delete"})}function u(t){return Object(i["a"])({url:"/admin/the_house/category/list",method:"get",params:t})}function c(t){return Object(i["a"])({url:"/admin/the_house/category/"+t,method:"get"})}function h(t){return Object(i["a"])({url:"/admin/the_house/category/store",method:"post",data:t})}function m(t,e){return Object(i["a"])({url:"/admin/the_house/category/"+t,method:"post",data:e})}function d(t){return Object(i["a"])({url:"/admin/the_house/category/"+t,method:"delete"})}function f(t){return Object(i["a"])({url:"/admin/the_house_content/list",method:"get",params:t})}function p(t){return Object(i["a"])({url:"/admin/the_house_content/"+t,method:"get"})}function g(t){return Object(i["a"])({url:"/admin/the_house_content",method:"post",data:t})}function b(t,e){return Object(i["a"])({url:"/admin/the_house_content/"+t,method:"post",data:e})}function y(t){return Object(i["a"])({url:"/admin/the_house_content/"+t,method:"delete"})}function v(){return Object(i["a"])({url:"/admin/the_houses",method:"get"})}},cf69:function(t,e,n){"use strict";var i=n("778a"),a=n.n(i);a.a}}]);