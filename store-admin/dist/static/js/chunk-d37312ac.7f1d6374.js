(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d37312ac"],{"468a":function(t,e,i){"use strict";var a=i("8087"),n=i.n(a);n.a},"639a":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("el-card",[i("el-form",{ref:"form",attrs:{model:t.form,inline:!0,"label-position":"right"}},[i("el-row",[i("el-col",[i("el-form-item",{attrs:{label:"所属分类"}},[t.formDisable?i("el-input",{staticStyle:{width:"400px"},attrs:{readonly:t.formDisable},model:{value:t.form.the_house_category.name,callback:function(e){t.$set(t.form.the_house_category,"name",e)},expression:"form.the_house_category.name"}}):i("el-select",{staticStyle:{width:"190px"},attrs:{placeholder:"请选择"},model:{value:t.form.the_house_category_id,callback:function(e){t.$set(t.form,"the_house_category_id",e)},expression:"form.the_house_category_id"}},t._l(t.theHouseCategoryList,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1)],1),i("el-row",[i("el-col",{attrs:{span:10}},[i("div",{staticStyle:{width:"470px","margin-bottom":"25px"}},[t.formDisable?t._e():i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",plain:"",icon:"el-icon-edit-outline"},on:{click:function(e){return t.handleDescribes("title")}}}),i("el-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[i("el-collapse-item",{attrs:{name:"title"}},[i("template",{slot:"title"},[i("span",{staticClass:"theHouseText"},[t._v("文案大标题")])]),i("span",{domProps:{innerHTML:t._s(t.form.title)}})],2)],1)],1)]),i("el-col",{attrs:{span:10}},[i("div",{staticStyle:{width:"470px","margin-bottom":"25px"}},[t.formDisable?t._e():i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",plain:"",icon:"el-icon-edit-outline"},on:{click:function(e){return t.handleDescribes("sub_title")}}}),i("el-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[i("el-collapse-item",{attrs:{name:"sub_title"}},[i("template",{slot:"title"},[i("span",{staticClass:"theHouseText"},[t._v("文案副标题")])]),i("span",{domProps:{innerHTML:t._s(t.form.sub_title)}})],2)],1)],1)])],1),i("el-row",[i("el-col",{attrs:{span:10}},[i("div",{staticStyle:{width:"470px","margin-bottom":"25px"}},[t.formDisable?t._e():i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",plain:"",icon:"el-icon-edit-outline"},on:{click:function(e){return t.handleDescribes("describe")}}}),i("el-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[i("el-collapse-item",{attrs:{name:"describe"}},[i("template",{slot:"title"},[i("span",{staticClass:"theHouseText"},[t._v("简要描述")])]),i("span",{domProps:{innerHTML:t._s(t.form.describe)}})],2)],1)],1)])],1),i("el-row",[i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:"banner图"}},[t.formDisable?i("el-image",{staticStyle:{width:"120px",height:"120px"},attrs:{src:t.form.banner,fit:"scale-down"},on:{click:function(e){return t.previewImgAction(t.form.banner)}}}):i("el-upload",{ref:"uploadBanner",class:{hideBanner:t.hideUploadBanner},attrs:{name:"banner",action:"#","list-type":"picture-card","auto-upload":!1,limit:t.limitCountBanner,"file-list":t.bannerList,"on-change":t.handleBannerChange,"on-remove":t.handleBannerRemove}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传一张jpg/png文件，且不超过500kb")])],1)],1)],1),i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:"缩略图"}},[t.formDisable?i("el-image",{staticStyle:{width:"120px",height:"120px"},attrs:{src:t.form.thumbnail,fit:"scale-down"},on:{click:function(e){return t.previewImgAction(t.form.thumbnail)}}}):i("el-upload",{ref:"uploadThumbnail",class:{hideThumbnail:t.hideUploadThumbnail},attrs:{name:"thumbnail",action:"#","list-type":"picture-card","auto-upload":!1,limit:t.limitCountThumbnail,"file-list":t.thumbnailList,"on-change":t.handleThumbnailChange,"on-remove":t.handleThumbnailRemove}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传一张jpg/png文件，且不超过500kb")])],1)],1)],1)],1)],1)],1),t.formDisable?t._e():i("el-card",{staticClass:"box-card-image",attrs:{shadow:"hover"}},[i("el-row",{staticStyle:{"margin-bottom":"50px"}},[i("el-col",{attrs:{span:2,offset:8}},[i("el-button",{attrs:{type:"success"},on:{click:function(e){return t.submitTheHouse()}}},[t._v("提交")])],1),i("el-col",{attrs:{span:2}},[i("el-button",{attrs:{type:"info",plain:""},on:{click:t.closePageButton}},[t._v("返回")])],1)],1)],1),"view"===t.status?i("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[i("div",{staticClass:"clearfix",staticStyle:{"margin-top":"10px",float:"right"},attrs:{slot:"header"},slot:"header"},[i("router-link",{attrs:{to:{name:"ContentView",params:{status:"create",content_id:"",the_house_id:t.form.id}}}},[i("el-button",{directives:[{name:"waves",rawName:"v-waves"}]},[t._v("添加")])],1)],1),i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[t._v("The House文案")])]),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.form.the_house_contents,"row-style":{height:"10px"},border:"","header-cell-style":{background:"#ebeef5"}}},[i("el-table-column",{attrs:{type:"index","header-align":"center",align:"center",label:"序号",width:"60"}}),i("el-table-column",{attrs:{"header-align":"center",align:"center",label:"文案标题"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("router-link",{attrs:{to:{name:"ContentView",params:{status:"view",content_id:e.row.id}}}},[i("el-tag",[t._v(t._s(e.row.title))])],1)]}}],null,!1,754152983)}),i("el-table-column",{attrs:{"header-align":"center",align:"center",label:"文案正文"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("p",{domProps:{innerHTML:t._s(e.row.content)}})]}}],null,!1,1758161622)}),i("el-table-column",{attrs:{"header-align":"center",align:"center",label:"文案配图"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[i("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:a.img,fit:"scale-down"},on:{click:function(e){return t.previewImgAction(a.img)}}})]}}],null,!1,3832561338)}),i("el-table-column",{attrs:{"header-align":"center",align:"center",prop:"img_desc",label:"图片描述"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("p",{domProps:{innerHTML:t._s(e.row.img_desc)}})]}}],null,!1,591702258)}),i("el-table-column",{attrs:{"header-align":"center",align:"center",prop:"created_at",label:"创建时间"}}),i("el-table-column",{attrs:{"header-align":"center",align:"center",prop:"updated_at",label:"更新时间"}})],1)],1):t._e(),i("el-dialog",{attrs:{title:"图片预览",visible:t.previewImgDialogVisible,width:"50%"},on:{"update:visible":function(e){t.previewImgDialogVisible=e}}},[i("el-image",{staticStyle:{width:"100%"},attrs:{src:t.previewImg}})],1),i("el-dialog",{attrs:{title:"富文本编辑",visible:t.showDialog,width:"50%","before-close":t.handleClose},on:{"update:visible":function(e){t.showDialog=e}}},[i("tinymce",{attrs:{height:150},model:{value:t.tinyTxt,callback:function(e){t.tinyTxt=e},expression:"tinyTxt"}}),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.showDialog=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.confirmSaveTiny}},[t._v("确 定")])],1)],1)],1)},n=[],s=i("8256"),o=i("a718"),r={name:"CreateOrView",components:{Tinymce:s["a"]},data:function(){return{status:"",form:{title:"",sub_title:"",describe:"",thumbnail:"",banner:"",the_house_category_id:""},theHouseCategoryList:[],the_house_slug:"",showDialog:!1,tinyTxt:"",flag:"",formDisable:!1,activeNames:["title","sub_title","describe"],hideUploadBanner:!1,limitCountBanner:1,bannerList:[],hideUploadThumbnail:!1,limitCountThumbnail:1,thumbnailList:[],previewImg:"",previewImgDialogVisible:!1}},created:function(){this.getInitData(),this.getHouseCategory()},methods:{getInitData:function(){this.status=this.$route.params.status,"view"===this.status?(this.the_house_slug=this.$route.params.the_house_slug,this.formDisable=!0,this.getHouseDetail()):"edit"===this.status&&(this.the_house_slug=this.$route.params.the_house_slug,this.getHouseDetail())},getHouseCategory:function(){var t=this;Object(o["h"])().then((function(e){t.theHouseCategoryList=e.data.data}))},getHouseDetail:function(){var t=this;Object(o["m"])(this.the_house_slug).then((function(e){t.form=e.data,t.bannerList.push({url:t.form.banner}),t.thumbnailList.push({url:t.form.thumbnail}),t.hideUploadBanner=!0,t.hideUploadThumbnail=!0}))},handleDescribes:function(t){this.flag=t,this.tinyTxt="",this.showDialog=!0},confirmSaveTiny:function(){switch(this.flag){case"title":this.form.title=this.tinyTxt,this.showDialog=!1,this.tinyTxt="";break;case"sub_title":this.form.sub_title=this.tinyTxt,this.showDialog=!1,this.tinyTxt="";break;case"describe":this.form.describe=this.tinyTxt,this.showDialog=!1,this.tinyTxt="";break}this.$message({message:"编辑完成",type:"success"})},handleClose:function(t){this.$confirm("确认关闭？").then((function(e){t()})).catch((function(t){}))},handleBannerChange:function(t,e){this.hideUploadBanner=e.length>=this.limitCountBanner,this.form.banner=t.raw},handleBannerRemove:function(t,e){this.hideUploadBanner=e.length>=this.limitCountBanner,this.form.banner=null},handleThumbnailChange:function(t,e){this.hideUploadThumbnail=e.length>=this.limitCountThumbnail,this.form.thumbnail=t.raw},handleThumbnailRemove:function(t,e){this.hideUploadThumbnail=e.length>=this.limitCountThumbnail,this.form.thumbnail=null},previewImgAction:function(t){this.previewImg=t,this.previewImgDialogVisible=!0},closePageButton:function(){this.$store.dispatch("tagsView/delView",this.$route),this.$router.go(-1)},submitTheHouse:function(){return this.form.title?this.form.sub_title?this.form.describe?void("create"===this.status?this.theHouseStore():"edit"===this.status&&this.theHouseUpdate()):(this.$message({message:"简要描述不可为空！",type:"warning"}),!1):(this.$message({message:"文案副标题不可为空！",type:"warning"}),!1):(this.$message({message:"文案大标题不可为空！",type:"warning"}),!1)},theHouseStore:function(){var t=this,e=new FormData;for(var i in this.form)e.append(i,this.form[i]);Object(o["o"])(e).then((function(e){20001===e.code?(t.initFormData(),t.$message({type:"success",message:"创建成功！"}),t.closePageButton()):t.$message({type:"error",message:"创建失败，请检查参数！"})}))},theHouseUpdate:function(){var t=this;delete this.form["the_house_category"];var e=new FormData;for(var i in this.form)e.append(i,this.form[i]);Object(o["p"])(this.form.slug,e).then((function(e){20001===e.code?(t.$message({type:"success",message:"更新成功！"}),t.closePageButton()):t.$message({type:"error",message:"更新失败，请检查参数！"})}))},initFormData:function(){this.$refs["form"].resetFields(),this.form.title="",this.form.sub_title="",this.form.describe="",this.form.banner="",this.bannerList=[],this.hideUploadBanner=!1,this.form.thumbnail="",this.thumbnailList=[],this.hideUploadThumbnail=!1}}},l=r,u=(i("468a"),i("2877")),c=Object(u["a"])(l,a,n,!1,null,null,null);e["default"]=c.exports},8087:function(t,e,i){},a718:function(t,e,i){"use strict";i.d(e,"n",(function(){return n})),i.d(e,"m",(function(){return s})),i.d(e,"o",(function(){return o})),i.d(e,"p",(function(){return r})),i.d(e,"l",(function(){return l})),i.d(e,"h",(function(){return u})),i.d(e,"g",(function(){return c})),i.d(e,"i",(function(){return h})),i.d(e,"j",(function(){return m})),i.d(e,"f",(function(){return d})),i.d(e,"k",(function(){return f})),i.d(e,"b",(function(){return p})),i.d(e,"c",(function(){return b})),i.d(e,"e",(function(){return g})),i.d(e,"a",(function(){return _})),i.d(e,"d",(function(){return v}));var a=i("b775");function n(t){return Object(a["a"])({url:"admin/the_houses",method:"get",params:t})}function s(t){return Object(a["a"])({url:"/admin/the_house/"+t,method:"get"})}function o(t){return Object(a["a"])({url:"/admin/the_house",method:"post",data:t})}function r(t,e){return Object(a["a"])({url:"/admin/the_house/"+t,method:"post",data:e})}function l(t){return Object(a["a"])({url:"/admin/the_house/"+t,method:"delete"})}function u(t){return Object(a["a"])({url:"/admin/the_house/category/list",method:"get",params:t})}function c(t){return Object(a["a"])({url:"/admin/the_house/category/"+t,method:"get"})}function h(t){return Object(a["a"])({url:"/admin/the_house/category/store",method:"post",data:t})}function m(t,e){return Object(a["a"])({url:"/admin/the_house/category/"+t,method:"post",data:e})}function d(t){return Object(a["a"])({url:"/admin/the_house/category/"+t,method:"delete"})}function f(t){return Object(a["a"])({url:"/admin/the_house_content/list",method:"get",params:t})}function p(t){return Object(a["a"])({url:"/admin/the_house_content/"+t,method:"get"})}function b(t){return Object(a["a"])({url:"/admin/the_house_content",method:"post",data:t})}function g(t,e){return Object(a["a"])({url:"/admin/the_house_content/"+t,method:"post",data:e})}function _(t){return Object(a["a"])({url:"/admin/the_house_content/"+t,method:"delete"})}function v(){return Object(a["a"])({url:"/admin/the_houses",method:"get"})}}}]);